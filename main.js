const {app, Tray, Menu, nativeImage, BrowserWindow, nativeTheme, systemPreferences} = require("electron");
const path = require("path");
const lcd =  require("./capellix.js");

nativeTheme.themeSource = "dark";

let imagevar = "/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCAHgAeADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAorhv2nPjnZ/sx/s4+PPiNqFpNqFl4E8P32vTWkLbJLpbaB5jErEEAts2gkYGc1zH7Af7WK/t0fsbfD74uL4fm8Kjx3pS6l/ZMt4t41ll2Qr5yqgcfLkNtUkEZVTkAj7yk19m1/8At7mt9/K/u16B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KKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/9k=";

const LCD = new lcd.LCD();

let fps = setInterval(() => LCD.sendFrame(imagevar), 1000/30);

const createWindow = () => {
    const mainWindow = new BrowserWindow({
        width: 1200,
        height: 800,
        webPreferences: {
            preload: path.join(__dirname, "preload.js")
        }
    })
    mainWindow.loadFile("renderer.html");
    mainWindow.removeMenu()
}

app.whenReady().then(() => {
    createWindow();
    createTray();
})

const createTray = () => {
    const icon = nativeImage.createFromDataURL('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAACsZJREFUWAmtWFlsXFcZ/u82++Jt7IyT2Em6ZFHTpAtWIzspEgjEUhA8VNAiIYEQUvuABBIUwUMkQIVKPCIoEiABLShISEBbhFJwIGRpIKRpbNeJ7bh2HHvssR3PPnPnLnzfmRlju6EQqUc+c++c8y/fv54z1uQOh+/7Glh0TD59TE/TND7lnfa4/64OKsM071QoeZpA/y9WWvk/B4XCC06TUC+Xyw8HTXNQ1+Ww6PpOrMebewXxvBueJ6/XHOdMJBL5J9Y97m2R0SS/wweE6JxkGx5dilWr1S/7dXsEa2o4+LyFmcFcaL5zbX3Y9gh5hpeWYpSB9XV5/H678V89BGYDXnHJlCsWn4gHrGc1K9CXxferOdvPOOKUfF8cH7nUyCtklQZXih/VNNlmirk3GdBSoIcRswW7/vVkLPYi5W2Uze8bh7J+4wLfh4dViFx5/nmrUi7/MhGNvrCkBfpeWqnW/7BUdadqntQ8zwr6vhUV34xpYnDynWvcmwQNaclDXsqgLMqkocPDw7fNx7d5qIX+/PmJxKGD6VdDkeh7ztyqOFfrokGCEWiiZ1mp0uITnuKAosaT7+pNxMYTyefutcQfbA+b1XLpH5fnF97/yD335Fu6mqTqsclDINBVmI4fDxw80KPAvJSt1MZtMcLiGxYUu83p4UkgnJZlqcl3LAj3WnTkIS9lUBYNPJjueVWgg7qocyOgliFqjZsg8gq5tRdiieQTf1gq15Y8CUbRZtyWOzZwc8lEqS3PTCtgqd13ieO68BQ2uNl64tXAewktrFuX2mPdkWAxn3sxnmx7sqUTJGqso8MGS9tbXFz8DMH8bblUX3T9QARVi8RV8qljfcJy0zRlaf6mzHEuzEtmekqCoZB4rqp0OmudHtUnlEWZlE0d1EWd1N3EozourcO65pw4eTIZQTW9VazJtbqvw9XwKVFQMsKDBuNhtp4uvGGFI+IDgKnpMjYyIis3ZsQMBIR7pONsIaMsyqRs6ohY1rPUSd3EQFDqo+kdZ3Fh4aupbdu+99uFQr2A1CBs4uEAjZjIFUMHi4dVxMXzCdCXQj4vBrwVCofl0ulTcv/DAxJJJBUPc8mpoyI2JDw7bFyT+ifTcSubyXytJ51+roWBxwG9Q73WWjZ7eSUU3//nXM0NI+x0PBGrTSgsLS9JFuFxHFrvSqIrJV279gi6tjiVspTza3JjZhY+0CQZj0mlWJSeHTslCro6eFqymCcVVN77kkGjs1p4sy2VOoSlOrFwT+XR+PjkgGaZ+ycKVbRTYUdVrmaImCvzk1dlFCEJdHRJ284+ie/ol0h7p7jFvExcvCCXzp2Rqem3pAMAiqWS6JGYhFI9Mjo6KjevXVUyKEuFHrKpY6JQ8TXT3D8+OTkAHBw6o6LCFo9ag3o4JtlCyTHEt5AxKvS6YUi5kJeZG3Py0NAxlLcJ9xti+K7Mjo/JfGZRuvv6Ze+9+yWEhDZAvzg3JyhX2d6/S7q6e+TimdOS7ElLKBZDwqvmj6rztayr1fVI1IoXi4PAcYZY1tPEEO1wEVlXgRFBDcmIXTqJsS+XyhKLJ5A/OpIVXXptWUYv/UvaenfIocEhMQ2EzHHErlXFCgQl3paU1eVl6QAY8sQTCSmVihKJx1V/ogvgIYF/pACdcMBhqONoHhF88/2d+bojyA6cRvje2IdFjoSjUSnBS8hgyS9lZOzKFdmPxO3o6gQIGzwuDn1dVSCtCKPy1pZXlATXqUsVYMLRmKo87vP4Y1ioqwCdCegmMYx3W/VPn8RrSDwwIMMbcEjkYo29JZVOy+ybI7K4eksODx1VSqvligpReSVLgySM/FI5h2q062jNyL3s7FtoAyGJIlx1225UmwJF6aJRJ3XzHXO9bWvsJa3jQFlBJkz6iuXdu32HzM7MyP0PPNgAU6ko4Qzp6b+flr8MD9OYJg9CwtzL5+T65ITs2bsP3mGxN/ZbBcOn0sk20gAkLQ+huXpFi8vkoY9AoyDjxTR1mbo6Ltt275HpN0dlNxQE40mVM8Ajjxx9VAGhAvQR1akZFCq799ADysMuQqOxh2FNmamEaz51ItGLfFD9+oUJoZkLowHoFA2mljUacqOMflKuVmHpfmnfvlMuvXZeStmMBIMhcWEdjgFJtrUjXI0KchAuAg0ilxLJNoRVBxhIBm0TjjKAuqjTqTs3CQZ6QUUMGFW7eiWMUg6w+yo8YMW7DqtqlZLkUDV2ISfd29KyDwk9MjYmMyOXxQIIKuShqo4VGFNBEgeDQYqVam5N5tEePFQgURIUBCsd1EWd1XrtDUUMLARD9bKaK5ytQ2Gb75g8WMiEP6VkfnZGevv6UF1vSBW5E0PFDAweFRvlfun8WVmamhDNrkmweQ0pwaPt6M4m8mgKTTFXqcrV0ZH1FKBg6qAu6qTuJiCV1Cp2Q0NDr9Uq5Ym+oMEDlSewsoRwrVBEaij7AJ4s7zrOpumxEdm15y6558GHJVe1Zezy6zJx6aJkpq5JFB4z6zVZmBiX1VWUP0IY4CFMYcpQdZ3xqIs6oftCE5DHKwd0q/tzOV8svdDb3nk8VnG9qmgQC0ZURz8Ur91alXgSByZ6ES9kZZTr/PR16UOCh+7dq0CWyyXJ4xqCQ0nKt9YQSlPue2gAeYZzD7yNLk0wmqAreb2WYSxAJ8Dget64wxtEBlDaqVOn/K5dB67t6+t5MhoMJuc8w8UPKiQ9CQR9JK5czhZAQxPt7TKF3OiAIisUViAD2Lg5d0P2HDgoKeRaW0enyqVwBJcO5fFG5dqa7h406qaeX8384uTZL5w9+UqxhYHFp0YLIYA9ddfu3T+4UJF6Rg+YAc9D0+RoIGP1ULhpWspr10evyK7+ftWTrk9PS/++A9KZSm26cih2mMOErem6n/ZsZwA2TM/MPHXs2LEftnSTbh0Q36mIIbx44cLvOnu3f+xUwbWLmoHTCUlF6g2jBQo/GnFrnGNqSHdvr+rIKGMW1KahwEBdzHft98aNwMr8zd8/NDDwccihc0hLi3GubRjY0Bm6H19fPvnZI4c/fHd7PJ2peXYZ+WQ26JufZELjQ6lbAQtnWre0d3apY8TFIdtAo+Qri6mupsB49lBMC+QXF0YefObZT8j0eKWlswVjEyCCOXHihPGb575VCvVuf3lvetsH9rXF0rla3cnhpoIGjgsUPhR3I4TMKYJQV1Z6WO02aEjHa5mNe3OPW3OPRHVrbXFh9Ocvv/KR1372owx1Pf3005uc35Ddgtd8rsf06IdS5777zZ+mUqmPzjm6TPpmvayZOq4LyATeCzkanmiy4qEuC/yXiO8CSMRzvLs1x9phepLNZl868sy3Pyen/5hd1/EfRvWmuvSWNeaRS/RkPDI4+NjE1NSXEoXlpaNB1zqo20abi59/vu/UfM2pie7WUDVq8l3wTwnskeZ+zTbIQ17KoCzKpGzq2KqX32/roRbh8ePHdUzl0s9/5Rv9n/7go19MxCKfCkZiu3V06wrO5gocxL7Dgd/IEobEMH6rejg+auXidL5Y/vWv/vTX53/y/e/MkGajTH7fOt4RUJOY1df4RdtY6ICFRzqTySOhUOA+3Ai3o31H1ZbnlXBruFmt2iMrudy5xx9//BzWV7nXDBGN2xpjbt/5oGUEdhtO3iD47xZOvm8a5CHvpsV38wsUaMwBWsz3rbK5xr0mzdv2t9Jv/f5vhsF4J+Q63IUAAAAASUVORK5CYII=')
    tray = new Tray(icon)

    const contextMenu = Menu.buildFromTemplate([
        { label: 'Open CapellixLCD', click() { createWindow(); }},
        { label: 'Start Rendering' },
        { label: 'Quit CapellixLCD', click() { app.exit(0); } }
    ])

    tray.setToolTip('CapellixLCD')
    tray.setContextMenu(contextMenu)
}

app.on("window-all-closed", () => {
    app.exit(0);
})